{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../src/kademlia/services/eventmanager/index.ts"],"names":[],"mappings":";;;AAEA,8DAA4B;AAQ5B,MAAqB,YAAY;IAK/B,YAAmB,UAAsB;QAAtB,eAAU,GAAV,UAAU,CAAY;QAJzC,UAAK,GAAG,IAAI,iBAAK,EAAuB,CAAC;QACzC,aAAQ,GAAG,IAAI,iBAAK,EAA0B,CAAC;QAC/C,cAAS,GAAG,IAAI,iBAAK,EAA2B,CAAC;IAEL,CAAC;IAE7C,MAAM,CAAC,IAAU;QACf,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QACvB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;QAC1B,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;IAC7B,CAAC;IAEO,WAAW,CAAC,IAAU;QAC5B,IAAI,CAAC,UAAU;aACZ,YAAY,CAAQ,OAAO,EAAE,IAAI,CAAC;aAClC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;IACzD,CAAC;IAEO,cAAc,CAAC,IAAU;QAC/B,IAAI,CAAC,UAAU;aACZ,YAAY,CAAW,UAAU,EAAE,IAAI,CAAC;aACxC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;IAC5D,CAAC;IAEO,eAAe,CAAC,IAAU;QAChC,IAAI,CAAC,UAAU;aACZ,YAAY,CAAY,WAAW,EAAE,IAAI,CAAC;aAC1C,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;IAC7D,CAAC;CACF;AA9BD,+BA8BC","sourcesContent":["import RpcManager, { ID } from \"../rpcmanager\";\n\nimport Event from \"rx.mini\";\nimport { FindNode } from \"../../actions/findnode\";\nimport { FindValue } from \"../../actions/findvalue\";\nimport { Peer } from \"../../modules/peer/base\";\nimport { Store } from \"../../actions/store\";\n\ntype Execute<T> = { res: T; peer: Peer };\n\nexport default class EventManager {\n  store = new Event<Execute<Store & ID>>();\n  findnode = new Event<Execute<FindNode & ID>>();\n  findvalue = new Event<Execute<FindValue & ID>>();\n\n  constructor(public rpcManager: RpcManager) {}\n\n  listen(peer: Peer) {\n    this.listenStore(peer);\n    this.listenFindnode(peer);\n    this.listenFindvalue(peer);\n  }\n\n  private listenStore(peer: Peer) {\n    this.rpcManager\n      .asObservable<Store>(\"Store\", peer)\n      .subscribe(res => this.store.execute({ res, peer }));\n  }\n\n  private listenFindnode(peer: Peer) {\n    this.rpcManager\n      .asObservable<FindNode>(\"FindNode\", peer)\n      .subscribe(res => this.findnode.execute({ res, peer }));\n  }\n\n  private listenFindvalue(peer: Peer) {\n    this.rpcManager\n      .asObservable<FindValue>(\"FindValue\", peer)\n      .subscribe(res => this.findvalue.execute({ res, peer }));\n  }\n}\n"]}