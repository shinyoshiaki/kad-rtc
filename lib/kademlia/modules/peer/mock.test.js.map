{"version":3,"file":"mock.test.js","sourceRoot":"","sources":["../../../../src/kademlia/modules/peer/mock.test.ts"],"names":[],"mappings":";;;AAAA,iCAAoC;AAEpC,QAAQ,CAAC,MAAM,EAAE,GAAG,EAAE;IACpB,IAAI,CACF,MAAM,EACN,GAAS,EAAE;QACT,MAAM,IAAI,GAAG,GAAG,EAAE,CAChB,IAAI,OAAO,CAAC,CAAM,OAAO,EAAC,EAAE;YAC1B,IAAI,KAAK,GAAG,CAAC,CAAC;YACd,MAAM,GAAG,GAAG,GAAG,EAAE;gBACf,KAAK,EAAE,CAAC;gBACR,IAAI,KAAK,KAAK,CAAC;oBAAE,OAAO,EAAE,CAAC;YAC7B,CAAC,CAAC;YAEF,MAAM,CAAC,GAAG,iBAAU,CAAC,GAAG,CAAC,CAAC;YAC1B,MAAM,CAAC,GAAG,iBAAU,CAAC,GAAG,CAAC,CAAC;YAC1B,MAAM,KAAK,GAAG,MAAM,CAAC,CAAC,WAAW,EAAE,CAAC;YACpC,MAAM,MAAM,GAAG,MAAM,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACvC,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;YAEpB,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,GAAS,EAAE;gBAC1B,MAAM,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;gBACpC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;gBACZ,MAAM,GAAG,GAAG,MAAM,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,CAAC;gBAC9C,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBAC1B,GAAG,EAAE,CAAC;YACR,CAAC,CAAA,CAAC,CAAC;YACH,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,GAAS,EAAE;gBAC1B,MAAM,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;gBACpC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;gBACZ,MAAM,GAAG,GAAG,MAAM,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,CAAC;gBAC9C,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBAC1B,GAAG,EAAE,CAAC;YACR,CAAC,CAAA,CAAC,CAAC;QACL,CAAC,CAAA,CAAC,CAAC;QACL,MAAM,IAAI,EAAE,CAAC;IACf,CAAC,CAAA,EACD,IAAI,GAAG,IAAI,CACZ,CAAC;AACJ,CAAC,CAAC,CAAC","sourcesContent":["import { PeerModule } from \"./mock\";\n\ndescribe(\"mock\", () => {\n  test(\n    \"test\",\n    async () => {\n      const test = () =>\n        new Promise(async resolve => {\n          let count = 0;\n          const end = () => {\n            count++;\n            if (count === 2) resolve();\n          };\n\n          const a = PeerModule(\"a\");\n          const b = PeerModule(\"b\");\n          const offer = await a.createOffer();\n          const answer = await b.setOffer(offer);\n          a.setAnswer(answer);\n\n          a.onConnect.once(async () => {\n            const data = { rpc: \"a\", msg: \"a\" };\n            a.rpc(data);\n            const res = await a.eventRpc(\"b\").asPromise();\n            expect(res.msg).toBe(\"b\");\n            end();\n          });\n          b.onConnect.once(async () => {\n            const data = { rpc: \"b\", msg: \"b\" };\n            b.rpc(data);\n            const res = await b.eventRpc(\"a\").asPromise();\n            expect(res.msg).toBe(\"a\");\n            end();\n          });\n        });\n      await test();\n    },\n    1000 * 6000\n  );\n});\n"]}